#!/usr/bin/env sh

# Script to search terms in search engines

source d-var.conf

query="${1:-$(printf "$(wl-paste -p)\n$(wl-paste)" | $D_MENU -i -p 'ï‘Œ ')}"
echo "$feed" | wl-copy -n
# For prompt/notify on chosen link
shortquery="$(echo ${feed} | cut -d '/' -f3,4,5,6 )"

browsertab=("ï‰©  Firefox" "ï’ˆ  Librewolf" "ï€Š  Brave" "ó°–‚ MullVad")
enginestab=(
    "ðŸ”— Website/URL" #0
    "îŠ§  Brave" #1
    "ï‡ª  Google Scholar" #2
    "ïŠ  Reddit" #3
    "ïŒ“  NixPkgs" #4
    "ï„‰  MyNixOS" #5
    "ï„“  Nixhub - pkgver" #6
    "ó°‚¦  NCBI" #7
    "ó°“  BioConductor" #8
    "ó°£‡  Arch-Wiki" #9
    "ó°‚º  Libgen-Zlib-Books" #10
    "ï‚›  GitHub" #11
    "îˆš  AnimeTosho" #12
    "ó°„›  NyaaSi" #13
    "ï€¾  Getty Images" #14
    "ó°‡¥  DuckDuckGo" #15
    "ï‹  1337 Torrent" #16

)

viabrowser () {
    echo "Opening ï€‚ ${nowsearch} in ï’ˆ $nowbrowser"
    setsid -f $nowbrowser "${nowsearch}" >/dev/null 2>&1
}

getbrowser="$(printf '%s\n' "${browsertab[@]}" | $D_MENU -p "${shortfeed}")"

case $getbrowser in
    "${browsertab[0]}") nowbrowser="firefox" ;;
    "${browsertab[1]}") nowbrowser="librewolf" ;;
    "${browsertab[2]}") nowbrowser="brave" ;;
    "${browsertab[3]}") nowbrowser="mullvad" ;;
esac

dosearch="$(printf '%s\n' "${enginestab[@]}" | $D_MENU -p "${shortfeed}")"

case $dosearch in
    "${enginestab[0]}") nowsearch="${query}" ;;
    "${enginestab[1]}") nowsearch="https://search.brave.com/search?q=$query" ;;
    "${enginestab[2]}") nowsearch="https://scholar.google.com/scholar?&q=$query" ;;
    "${enginestab[3]}") nowsearch="https://old.reddit.com/search?q=$query" ;;
    "${enginestab[4]}") nowsearch="https://search.nixos.org/packages?channel=unstable&from=0&size=50&sort=relevance&type=packages&query=$query" ;;
    "${enginestab[5]}") nowsearch="https://mynixos.com/search?q=$query" ;;
    "${enginestab[6]}") nowsearch="https://www.nixhub.io/search?q=$query" ;;
    "${enginestab[7]}") nowsearch="https://www.ncbi.nlm.nih.gov/search/all/?term=$query" ;;
    "${enginestab[8]}") nowsearch="https://www.bioconductor.org/help/search/index.html?q=$query" ;;
    "${enginestab[9]}") nowsearch="https://wiki.archlinux.org/index.php?search=$query" ;;
    "${enginestab[10]}") nowsearch="https://libgen.rs/search.php?req=$query" ;;
    "${enginestab[11]}") nowsearch="https://github.com/search?q=$query&type=repositories" ;;
    "${enginestab[12]}") nowsearch="https://animetosho.org/search?q=$query" ;;
    "${enginestab[13]}") nowsearch="https://nyaa.si/?f=0&c=0_0&q=$query" ;;
    "${enginestab[14]}") nowsearch="https://www.gettyimages.in/search/2/image?family=creative&phrase=$query";;
    "${enginestab[15]}") nowsearch="https://duckduckgo.com/?q=$query" ;;
    "${enginestab[16]}") nowsearch="https://1337x.to/search/$query/1";;
esac

viabrowser
